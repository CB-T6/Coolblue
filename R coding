#Coolblue

#Check for missing values 
apply(is.na(broadcasting_data[,]),2,sum) 
apply(is.na(traffic_data[,]),2,sum) # average session: 13,5% of missing values & 
                                    # bounces :49% of missing values . We delete variable "bounces"
                                   
#Deleting "bounces"
traffic_data <- subset(traffic_data, select = -c(bounces))
summary(traffic_data)                                   
                                   
#Convert into dates
traffic_data$date_time <- as.POSIXct(traffic_data$date_time)
broadcasting_data$date <- as.POSIXct(broadcasting_data$date)

#Factorize
traffic_data$medium <- as.factor(traffic_data$medium)
traffic_data$visit_source <- as.factor(traffic_data$visit_source)
traffic_data$page_category<-as.factor(traffic_data$page_category)
traffic_data$country<-as.factor(traffic_data$country)
broadcasting_data$operator <- as.factor(broadcasting_data$operator)
broadcasting_data$channel <- as.factor(broadcasting_data$channel)
broadcasting_data$position_in_break <- as.factor(broadcasting_data$position_in_break)
broadcasting_data$length_of_spot <- as.factor(broadcasting_data$length_of_spot)
broadcasting_data$program_before <- as.factor(broadcasting_data$program_before)
broadcasting_data$program_after <- as.factor(broadcasting_data$program_after)
broadcasting_data$program_category_before <- as.factor(broadcasting_data$program_category_before)
broadcasting_data$program_category_after <- as.factor(broadcasting_data$program_category_after)
broadcasting_data$product_category <- as.factor(broadcasting_data$product_category)
broadcasting_data$country <- as.factor(broadcasting_data$country)


#Find the mean 
mean(traffic_data$avg_session_quality, na.rm = TRUE)

#Converting NAs to mean
traffic_data <- traffic_data  %>% 
  mutate(avg_session_quality = if_else(is.na(avg_session_quality) == TRUE, 
                                 mean(avg_session_quality, na.rm = TRUE), avg_session_quality))


#Check for outliers
boxplot(broadcasting_data$gross_rating_point,xlab ="gross_rating_point")          # many  outliers, not gonna delete them, important for analysis
boxplot(traffic_data$avg_session_quality,xlab ="avg_session_quality")






                              
                                   
